CLS
SET SCOR OFF
SET ESCAPE OFF
DO WHILE .T.

SET COLOR TO N/N
@ 00,00 CLEAR TO 24,79
JANELA(07,11,12,66)
SET COLOR TO B+/W+
@ 08,24 SAY "SEJA BEM VINDO A PROVA DE IPD"
@ 10,13 SAY REPLICATE("#",52)
FOR X=26 TO 128
INKEY(0.1)
@ 10,X/2 SAY "#" COLOR"B/B"
@ 11,28 SAY STR(X-28)+"%"
@ 11,14 SAY "VERIFICANDO"

****DESVIO CONDICIONAL PARA ANALISE DOS ARQUIVOS DO PROGRAMA
IF X=30
IF .NOT. FILE("AJUDA.TXT")
ALERT("VC NAO POSSUE O ARQUIVO DE AJUDA")
SET COLOR TO W/N
CLS
QUIT
EXIT
ELSE
@ 11,50 say "AJUDA.TXT"
ENDIF

ELSEIF X=65
IF .NOT. FILE("QUEST.TXT")
ALERT("VC NAO POSSUE O ARQUIVO DE QUESTIONARIO")
SET COLOR TO W/N
CLS
QUIT
EXIT
ELSE
@ 11,50 say "QUEST.TXT"
ENDIF

ELSEIF X=95
IF .NOT. FILE("CRIADOR.TXT")
ALERT("VC NAO POSSUE O ARQUIVO DE DADOS DO SISTEMA")
SET COLOR TO W/N
CLS
QUIT
EXIT
ELSE
@ 11,50 say "CRIADOR.TXT"
ENDIF
ENDIF
NEXT

@ 11,14 SAY SPACE(50)
@ 11,32 SAY "CONCLUIDO" COLOR"B+/W+"
INKEY(5)



****LAYOUT INICIAL DE IDENTIFICACAO DO ALUNO
SET KEY -9 TO SAIR()
SET COLOR TO N/N
@ 00,00 CLEAR TO 24,79
JANELA(07,12,12,64)
SET COLOR TO B+/W+,W/BG
NN=SPACE(30)
@ 08,24 SAY "SEJA BEM VINDO A PROVA DE IPD"
@ 10,14 SAY "DIGITE SEU NOME:" GET NN PICT"@!"
READ


****LAYOUT DO PROGRAMA
SET INTE OFF
SET COLOR TO B/W+
JANELA(00,00,24,79)
JANELA2(03,01,21,78)
@ 01,22 SAY "PROVA DO DEIVAO - BUZZ" COLOR"R+/W+"
@ 02,12 SAY "RESPONDA NA GRADE COM UM X NA ALTERNATIVA CORRETA" COLOR"B+/W+"
@ 22,03 SAY "ESC-FECHAR | F1-ABRIR | F2-SOBRE | F3-AJUDA | F5-ATUALIZAR | F10-SAIR" COLOR"B+/W+"



****TECLAS DE ATALHO DO PROGRAMA
SET KEY 28 TO QUEST()
SET KEY -1 TO SOBRE()
SET KEY -2 TO AJUDA()
SET KEY -4 TO ATUALIZAR()




****CONTORNOS E MARCACOES DA TABELA

*LINHAS
@ 08,21 TO 08,53
@ 10,21 TO 10,53
@ 12,21 TO 12,53
@ 14,21 TO 14,53

*COLUNAS
@ 07,24 TO 15,24
@ 07,27 TO 15,27
@ 07,30 TO 15,30
@ 07,33 TO 15,33
@ 07,36 TO 15,36
@ 07,39 TO 15,39
@ 07,42 TO 15,42
@ 07,45 TO 15,45
@ 07,48 TO 15,48
@ 07,51 TO 15,51

*MARCANDO COLUNAS
@ 07,25 SAY "1"
@ 07,28 SAY "2"
@ 07,31 SAY "3"
@ 07,34 SAY "4"
@ 07,37 SAY "5"
@ 07,40 SAY "6"
@ 07,43 SAY "7"
@ 07,46 SAY "8"
@ 07,49 SAY "9"
@ 07,52 SAY "10"

*MARCANDO LINHAS
@ 09,22 SAY "A"
@ 11,22 SAY "B"
@ 13,22 SAY "C"
@ 15,22 SAY "D"



****CAMPOS DO PROGRAMA

INICIAL=SAVESCREEN(00,00,24,79)
SET KEY -9 TO SAIR()
SET COLOR TO W/W+

A1=SPACE(1)
B1=SPACE(1)
C1=SPACE(1)
D1=SPACE(1)
@ 09,24 SAY "" GET A1 PICT"@!"
@ 11,24 SAY "" GET B1 PICT"@!"
@ 13,24 SAY "" GET C1 PICT"@!"
@ 15,24 SAY "" GET D1 PICT"@!"

A2=SPACE(1)
B2=SPACE(1)
C2=SPACE(1)
D2=SPACE(1)
@ 09,27 SAY "" GET A2 PICT"@!"
@ 11,27 SAY "" GET B2 PICT"@!"
@ 13,27 SAY "" GET C2 PICT"@!"
@ 15,27 SAY "" GET D2 PICT"@!"

A3=SPACE(1)
B3=SPACE(1)
C3=SPACE(1)
D3=SPACE(1)
@ 09,30 SAY "" GET A3 PICT"@!"
@ 11,30 SAY "" GET B3 PICT"@!"
@ 13,30 SAY "" GET C3 PICT"@!"
@ 15,30 SAY "" GET D3 PICT"@!"

A4=SPACE(1)
B4=SPACE(1)
C4=SPACE(1)
D4=SPACE(1)
@ 09,33 SAY "" GET A4 PICT"@!"
@ 11,33 SAY "" GET B4 PICT"@!"
@ 13,33 SAY "" GET C4 PICT"@!"
@ 15,33 SAY "" GET D4 PICT"@!"

A5=SPACE(1)
B5=SPACE(1)
C5=SPACE(1)
D5=SPACE(1)
@ 09,36 SAY "" GET A5 PICT"@!"
@ 11,36 SAY "" GET B5 PICT"@!"
@ 13,36 SAY "" GET C5 PICT"@!"
@ 15,36 SAY "" GET D5 PICT"@!"

A6=SPACE(1)
B6=SPACE(1)
C6=SPACE(1)
D6=SPACE(1)
@ 09,39 SAY "" GET A6 PICT"@!"
@ 11,39 SAY "" GET B6 PICT"@!"
@ 13,39 SAY "" GET C6 PICT"@!"
@ 15,39 SAY "" GET D6 PICT"@!"

A7=SPACE(1)
B7=SPACE(1)
C7=SPACE(1)
D7=SPACE(1)
@ 09,42 SAY "" GET A7 PICT"@!"
@ 11,42 SAY "" GET B7 PICT"@!"
@ 13,42 SAY "" GET C7 PICT"@!"
@ 15,42 SAY "" GET D7 PICT"@!"

A8=SPACE(1)
B8=SPACE(1)
C8=SPACE(1)
D8=SPACE(1)
@ 09,45 SAY "" GET A8 PICT"@!"
@ 11,45 SAY "" GET B8 PICT"@!"
@ 13,45 SAY "" GET C8 PICT"@!"
@ 15,45 SAY "" GET D8 PICT"@!"

A9=SPACE(1)
B9=SPACE(1)
C9=SPACE(1)
D9=SPACE(1)
@ 09,48 SAY "" GET A9 PICT"@!"
@ 11,48 SAY "" GET B9 PICT"@!"
@ 13,48 SAY "" GET C9 PICT"@!"
@ 15,48 SAY "" GET D9 PICT"@!"

A10=SPACE(1)
B10=SPACE(1)
C10=SPACE(1)
D10=SPACE(1)
@ 09,51 SAY "" GET A10 PICT"@!"
@ 11,51 SAY "" GET B10 PICT"@!"
@ 13,51 SAY "" GET C10 PICT"@!"
@ 15,51 SAY "" GET D10 PICT"@!"

READ


****CALCULOS DO PROGRAMA

SET COLOR TO W+/W+
@ 06,10 CLEAR TO 18,65
SET COLOR TO G/W+

R1=0
IF A1="X" .AND. B1<>"X" .AND. C1<>"X" .AND. D1<>"X"
R1=10
ENDIF

R2=0
IF A2="X" .AND. B2<>"X" .AND. C2<>"X" .AND. D2<>"X"
R2=10
ENDIF

R3=0
IF A3="X" .AND. B3<>"X" .AND. C3<>"X" .AND. D3<>"X"
R3=10
ENDIF

R4=0
IF A4="X" .AND. B4<>"X" .AND. C4<>"X" .AND. D4<>"X"
R4=10
ENDIF

R5=0
IF A5="X" .AND. B5<>"X" .AND. C5<>"X" .AND. D5<>"X"
R5=10
ENDIF

R6=0
IF A6="X" .AND. B6<>"X" .AND. C6<>"X" .AND. D6<>"X"
R6=10
ENDIF

R7=0
IF A7="X" .AND. B7<>"X" .AND. C7<>"X" .AND. D7<>"X"
R7=10
ENDIF

R8=0
IF A8="X" .AND. B8<>"X" .AND. C8<>"X" .AND. D8<>"X"
R8=10
ENDIF

R9=0
IF A9="X" .AND. B9<>"X" .AND. C9<>"X" .AND. D9<>"X"
R9=10
ENDIF

R10=0
IF A10="X" .AND. B10<>"X" .AND. C10<>"X" .AND. D10<>"X"
R10=10
ENDIF


RF=R1+R2+R3+R4+R5+R6+R7+R8+R9+R10
ALERT(ALLTRIM(NN)+", SUA NOTA ê"+ALLTRIM(STR(RF))+" !")


SET COLOR TO
SAIR()
ENDDO



*****************************************
*         FUNÄÂES DO SOFTWARE           *
*****************************************


FUNCTION JANELA(LI,CI,LF,CF)
SET COLOR TO W+/W+
@ LI,CI CLEAR TO LF,CF
SET COLOR TO W+/W+
@ LI,CI TO LF,CI COLOR"W+/W+"
@ LI,CF TO LF,CF COLOR"N/W+"
@ LI,CI TO LI,CF
@ LI,CI SAY CHR(218)
@ LI,CF SAY CHR(191) COLOR"N/W+"
SET COLOR TO N/W+
@ LF,CI TO LF,CF
@ LF,CI SAY CHR(192) COLOR"W+/W+"
@ LF,CF SAY CHR(217)





FUNCTION JANELA2(LI,CI,LF,CF)
SET COLOR TO W+/W+
@ LI,CI CLEAR TO LF,CF
SET COLOR TO N/W+
@ LI,CI TO LF,CI COLOR"N/W+"
@ LI,CF TO LF,CF COLOR"W+/W+"
@ LI,CI TO LI,CF
@ LI,CI SAY CHR(218)
@ LI,CF SAY CHR(191) COLOR"W+/W+"
SET COLOR TO W+/W+
@ LF,CI TO LF,CF
@ LF,CI SAY CHR(192) COLOR"N/W+"
@ LF,CF SAY CHR(217)





FUNCTION QUEST()
TELA=SAVESCREEN(00,00,24,79)
JANELA(04,11,21,68)
JANELA2(06,12,20,67)
SET COLOR TO W/B
@ 05,12 CLEAR TO 05,66
@ 05,28 SAY "QUESTIONARIO DE IPD"
SET COLOR TO B/W+
A=SPACE(50)
A=MEMOEDIT (MEMOREAD("QUEST.TXT"),07,13,19,66,.F.)
IF LASTKEY()=27
RESTSCREEN(00,00,24,79,TELA)
ENDIF





FUNCTION SOBRE()
TELA=SAVESCREEN(00,00,24,79)
JANELA(06,10,19,58)
JANELA2(08,11,18,57)
SET COLOR TO W/B
@ 07,11 CLEAR TO 07,57
@ 07,22 SAY "DETALHES SOBRE O CRIADOR"
SET COLOR TO B/W+
A=SPACE(50)
A=MEMOEDIT (MEMOREAD("CRIADOR.TXT"),09,12,17,56,.F.)
IF LASTKEY()=27
RESTSCREEN(00,00,24,79,TELA)
ENDIF





FUNCTION AJUDA()
TELA=SAVESCREEN(00,00,24,79)
JANELA(06,10,19,58)
JANELA2(08,11,18,57)
SET COLOR TO W/B
@ 07,11 CLEAR TO 07,57
@ 07,22 SAY "AJUDA DA PROVA DE IPD"
SET COLOR TO B/W+
A=SPACE(50)
A=MEMOEDIT (MEMOREAD("AJUDA.TXT"),09,12,17,56,.F.)
IF LASTKEY()=27
RESTSCREEN(00,00,24,79,TELA)
ENDIF





FUNCTION ATUALIZAR()
RESTSCREEN(00,00,24,79,INICIAL)
RETURN





FUNCTION SAIR()
VTELA=SAVESCREEN(00,00,24,79)
SET INTE ON
SET COLOR TO W/R,W+/B
@ 10,25 CLEAR TO 12,50
@ 10,25 TO 12,50
SS=0
@ 10,31 SAY "DESEJA SAIR?" COLOR"W+/R"
@ 11,27 PROMPT "   OK   "
@ 11,40 PROMPT "CANCELAR"
MENU TO SS
DO CASE
CASE SS=1
SET COLOR TO
CLS
QUIT
CASE SS=2
RESTSCREEN(00,00,24,79,VTELA)
ENDCASE

